{"version":3,"sources":["services/service.ts"],"names":["TodoService","TodoService.constructor","TodoService.getList","TodoService.addTask","TodoService.removeTask","TodoService.addTodo","TodoService.updateStatus"],"mappings":"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","file":"services/service.js","sourcesContent":["import {Injectable} from \"angular2/core\";\nimport {TodoModel} from \"../models/model\";\nimport {Task} from \"../models/task\";\nimport {Notification} from \"../services/notify\";\nimport {Http, Headers, HTTP_PROVIDERS} from 'angular2/http';\n// import {HTTP_BINDINGS} from 'angular2/http';\nimport {Observable} from 'rxjs/Observable';\nimport 'rxjs/add/operator/share';\nimport 'rxjs/add/operator/map';\n\nvar apiUrl = 'http://178.62.112.67:32778';\n// var apiUrl = 'http://localhost:8081';\n\n@Injectable()\nexport class TodoService {\n    todos$: Observable<Array<Task>>;\n    private _todosObserver: any;\n    private _dataStore : {\n        todos: Array<Task>\n    };\n    \n    public todos = [];\n    \n    constructor(private http: Http, public notification:Notification) {\n        this.todos$ = new Observable(observer => this._todosObserver = observer).share();\n        \n        this._dataStore = { todos: [] };\n    };\n    \n    public getList(status = 'todo') {\n        this.http.get(apiUrl+'/api/list', {search: 'status='+status})\n        .map((response) => {\n            // return response.json().data;\n            var data: Array<Task> = [];\n            response.json().data.forEach(function(value, index) {\n                data.push(new Task(value._id, value.name, value.description, value.status, value.date));\n            });\n            \n            return data;\n        })\n        .subscribe((data) => {\n            \n            this._dataStore.todos = data;\n            // console.log('data--->   ', data);\n            \n            this._todosObserver.next(this._dataStore.todos);\n        }, error => console.error('Could not load todos'));\n    }\n    \n    addTask(task:Task) {\n        var str = '';\n        Object.getOwnPropertyNames(task).forEach(function(val, idx, array) {\n            str += val + '=' + task[val]+'&';\n        });\n        let creds = JSON.stringify(str);\n        \n        var headers = new Headers();\n        headers.append('Content-Type', 'application/x-www-form-urlencoded');\n        this.http.post(apiUrl+'/api/add', creds, { headers: headers })\n            .map(response => response.json()).subscribe(data => {\n                var data = data.result;\n                var objTask = new Task(data._id, data.name, data.description, data.status, data.date);\n                this._dataStore.todos.push(objTask);   \n                this._todosObserver.next(this._dataStore.todos);\n                this.notification.show('success', 'Task Added');\n        }, error => console.log('Could not create todo.'));\n    }\n    \n    removeTask(task) {\n        var headers = new Headers();\n        this.http.delete(apiUrl+'/api/'+task.id+'/delete')\n            .map(response => response.json()).subscribe(data => {\n                this.notification.show('success', 'Task Removed');\n                this.getList();\n        }, error => console.log('Could not create todo.'));\n    }\n    \n    public addTodo(todo: TodoModel) {\n        if(todo) {\n            this.todos = [...this.todos, todo];\n        }\n    }\n    \n    \n    updateStatus(task, type) {\n        var str = '';\n        var currentStatus = task.status;\n        task.status = type;\n        Object.getOwnPropertyNames(task).forEach(function(val, idx, array) {\n            str += val + '=' + task[val]+'&';\n        });\n        let creds = JSON.stringify(str);\n        \n        var headers = new Headers();\n        headers.append('Content-Type', 'application/x-www-form-urlencoded');\n        this.http.put(apiUrl+'/api/'+task.id+'/update/status', creds, { headers: headers })\n            .map(response => response.json()).subscribe(data => {\n                this.notification.show('success', 'Task '+type);\n                this.getList(currentStatus);\n        }, error => console.log('Could not create todo.'));\n    }\n}"],"sourceRoot":"/source/"}